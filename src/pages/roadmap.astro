---
import BaseLayout from '../layouts/BaseLayout.astro';
import Section from '../components/ui/Section.astro';
import Container from '../components/ui/Container.astro';
import Badge from '../components/ui/Badge.astro';
import Button from '../components/ui/Button.astro';
import RoadmapTimeline from '../components/ui/RoadmapTimeline';
import CodeConstruct from '../components/ui/CodeConstruct';
import { roadmap } from '../content/copy';

const headlineParts = roadmap.hero.headline.split('ERP');
---

<BaseLayout
  title="Roadmap"
  description="Explore Lumina ERP's strategic roadmap — four phases of growth from core P21 services to SaaS tools, community resources, and industry events."
  schemaType="about"
>

  <!-- ═══════════════════════════════════════════════════════════
       HERO — "Building the Future"
       ═══════════════════════════════════════════════════════════ -->
  <Section background="base" padding="sm" class="pt-24 md:pt-32 pb-8 md:pb-14 relative overflow-hidden">
    <!-- Floating gradient orbs -->
    <div class="floating-orb absolute -top-24 -right-32 w-[400px] h-[400px] bg-accent-primary/5 rounded-full blur-3xl pointer-events-none"></div>
    <div class="floating-orb-2 absolute -bottom-20 -left-28 w-[350px] h-[350px] bg-accent-violet/5 rounded-full blur-3xl pointer-events-none"></div>

    <Container>
      <div class="max-w-3xl mx-auto text-center mb-8 md:mb-12">
        <!-- Badge -->
        <div class="hero-badge mb-4 md:mb-6">
          <Badge variant="primary">{roadmap.hero.badge}</Badge>
        </div>

        <!-- Headline with highlighted ERP -->
        <h1 class="hero-headline text-[length:var(--font-size-hero)] font-bold leading-[1.1] text-text-primary mb-4 md:mb-6">
          {headlineParts[0]}<span class="siri-glow">ERP</span>{headlineParts[1]}
        </h1>

        <!-- Subtitle -->
        <p class="hero-subtitle text-base md:text-lg text-text-secondary leading-relaxed max-w-2xl mx-auto">
          {roadmap.hero.subtitle}
        </p>
      </div>

      <!-- Code construct visual — centered, compact -->
      <div class="hero-terminal max-w-sm md:max-w-md mx-auto">
        <CodeConstruct client:visible />
      </div>
    </Container>
  </Section>

  <!-- ═══════════════════════════════════════════════════════════
       INTERACTIVE TIMELINE
       ═══════════════════════════════════════════════════════════ -->
  <Section background="base" padding="lg">
    <Container>
      <RoadmapTimeline phases={roadmap.phases} client:visible />
    </Container>
  </Section>

  <!-- ═══════════════════════════════════════════════════════════
       CTA
       ═══════════════════════════════════════════════════════════ -->
  <Section background="gradient" padding="lg">
    <Container>
      <div class="text-center max-w-2xl mx-auto relative section-reveal">
        <!-- Small floating orbs -->
        <div class="floating-orb absolute -top-16 -right-16 w-32 h-32 bg-accent-primary/5 rounded-full blur-2xl pointer-events-none"></div>
        <div class="floating-orb-2 absolute -bottom-12 -left-12 w-28 h-28 bg-accent-violet/5 rounded-full blur-2xl pointer-events-none"></div>

        <h2 class="text-[length:var(--font-size-h2)] font-bold text-text-primary mb-4">
          {roadmap.cta.heading}
        </h2>
        <p class="text-lg text-text-secondary mb-8">
          {roadmap.cta.subheading}
        </p>
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
          <Button href={roadmap.cta.buttonHref} arrow glow>{roadmap.cta.buttonLabel}</Button>
        </div>
        <p class="mt-6 text-text-tertiary text-sm">
          Or email us directly at <a href={`mailto:${roadmap.cta.email}`} class="text-accent-primary hover:underline">{roadmap.cta.email}</a>
        </p>
      </div>
    </Container>
  </Section>

</BaseLayout>

<!-- IntersectionObserver for scroll-triggered section reveals -->
<script>
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((e) => {
        if (e.isIntersecting) {
          e.target.classList.add('is-visible');
          observer.unobserve(e.target);
        }
      });
    },
    { threshold: 0.1, rootMargin: '-40px' }
  );
  document.querySelectorAll('.section-reveal').forEach((el) => observer.observe(el));
</script>

<style>
  /* ── Floating orb ambient motion ───────────────────────── */
  @keyframes float-slow {
    0%, 100% { transform: translateY(0px) translateX(0px); }
    33% { transform: translateY(-20px) translateX(10px); }
    66% { transform: translateY(10px) translateX(-5px); }
  }
  .floating-orb { animation: float-slow 20s ease-in-out infinite; }
  .floating-orb-2 { animation: float-slow 25s ease-in-out infinite reverse; }

  /* ── Hero entrance animations (staggered) ──────────────── */
  @keyframes hero-enter {
    from { opacity: 0; transform: translateY(40px) scale(0.96); }
    to { opacity: 1; transform: translateY(0) scale(1); }
  }
  .hero-badge {
    opacity: 0;
    animation: hero-enter 0.9s cubic-bezier(0.16, 1, 0.3, 1) 0.1s forwards;
  }
  .hero-headline {
    opacity: 0;
    animation: hero-enter 0.9s cubic-bezier(0.16, 1, 0.3, 1) 0.2s forwards;
  }
  .hero-subtitle {
    opacity: 0;
    animation: hero-enter 0.9s cubic-bezier(0.16, 1, 0.3, 1) 0.35s forwards;
  }
  .hero-terminal {
    opacity: 0;
    animation: hero-enter 0.9s cubic-bezier(0.16, 1, 0.3, 1) 0.5s forwards;
  }

  /* ── Section reveal on scroll ──────────────────────────── */
  .section-reveal {
    opacity: 0;
    transform: translateY(60px) scale(0.96);
    transition: opacity 0.9s cubic-bezier(0.16, 1, 0.3, 1),
                transform 0.9s cubic-bezier(0.16, 1, 0.3, 1);
  }
  .section-reveal.is-visible {
    opacity: 1;
    transform: translateY(0) scale(1);
  }

  /* ── Reduced motion — disable all animations ───────────── */
  @media (prefers-reduced-motion: reduce) {
    .floating-orb, .floating-orb-2 {
      animation: none;
    }
    .hero-badge, .hero-headline, .hero-subtitle, .hero-terminal {
      opacity: 1 !important;
      animation: none !important;
    }
    .section-reveal {
      opacity: 1 !important;
      transform: none !important;
      transition: none !important;
    }
  }
</style>
